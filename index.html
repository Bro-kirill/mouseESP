<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Virtual Touchpad</title>
<style>
  body { margin:0; height:100vh; display:flex; justify-content:center; align-items:center; background:#111; color:#eee; }
  #pad { width:90vw; height:90vh; background:#222; touch-action:none; }
</style>
</head>
<body>
<div id="pad"></div>

<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
<script>
const broker = "wss://broker.hivemq.com:8000/mqtt"; // WebSocket MQTT
const topic = "ipad/mouse/coords";

const client = mqtt.connect(broker);

client.on('connect', () => { console.log("Connected to MQTT broker!"); });

let lastX = 0;
let lastY = 0;

const pad = document.getElementById("pad");
pad.addEventListener("touchstart", e => {
  lastX = e.touches[0].clientX;
  lastY = e.touches[0].clientY;
});
pad.addEventListener("touchmove", e => {
  e.preventDefault();
  const x = e.touches[0].clientX;
  const y = e.touches[0].clientY;
  
  const dx = x - lastX;
  const dy = y - lastY;

  client.publish(topic, dx + "," + dy);

  lastX = x;
  lastY = y;
});
</script>
</body>
</html>
